<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>富邦俊德｜家族資產守護者</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-size: 19px; font-family: "Microsoft JhengHei", sans-serif; } 
        select { min-height: 60px !important; font-size: 1.1rem !important; font-weight: bold !important; border-radius: 1rem !important; }
        .fubon-blue { color: #00429d; }
        .fubon-bg { background-color: #00429d; }
        .btn-action { background-color: #00429d; }
        .animate-bounce-subtle { animation: bounceSubtle 2s infinite; }
        @keyframes bounceSubtle { 
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }
    </style>
</head>
<body class="bg-gray-50 py-2 min-h-screen">
    <div id="app" class="max-w-xl mx-auto px-4 pb-24">
        
        <header class="py-8 text-center">
            <div class="inline-block border-b-4 border-blue-600 pb-2 mb-2">
                <span class="fubon-bg text-white px-3 py-1 font-black text-xl rounded-md mr-1">富邦</span>
                <span class="fubon-blue text-2xl font-black tracking-widest">俊德</span>
            </div>
            <p class="text-blue-900 font-bold tracking-widest">您的家族資產守護者</p>
        </header>

        <div class="bg-white p-6 rounded-[2rem] shadow-lg border border-gray-100 mb-6">
            <h2 class="text-lg font-black text-gray-800 mb-6 flex items-center">
                <i class="fas fa-id-card-clip mr-2 fubon-blue"></i> 設定保單關係人
            </h2>
            <div class="space-y-6">
                <div>
                    <label class="text-xs font-black text-gray-400 mb-2 block tracking-widest uppercase">要保人 (付錢權利人)</label>
                    <select v-model="roles.owner" class="w-full bg-gray-50 border-2 border-gray-100 p-3 outline-none focus:border-blue-500">
                        <option v-for="p in persons" :key="p" :value="p">{{p}}</option>
                    </select>
                </div>
                <div>
                    <label class="text-xs font-black text-gray-400 mb-2 block tracking-widest uppercase">被保險人 (保單標的人)</label>
                    <select v-model="roles.insured" class="w-full bg-gray-50 border-2 border-gray-100 p-3 outline-none focus:border-blue-500">
                        <option v-for="p in persons" :key="p" :value="p">{{p}}</option>
                    </select>
                </div>
                <div>
                    <label class="text-xs font-black text-gray-400 mb-2 block tracking-widest uppercase">身故受益人 (領錢人)</label>
                    <select v-model="roles.beneficiary" class="w-full bg-gray-50 border-2 border-gray-100 p-3 outline-none focus:border-blue-500">
                        <optgroup label="指定人選">
                            <option v-for="p in availableBeneficiaries" :key="p" :value="p">{{p}}</option>
                        </optgroup>
                        <optgroup label="法律預設">
                            <option value="法定繼承人">⚖️ 法定繼承人</option>
                        </optgroup>
                    </select>
                </div>
            </div>
        </div>

        <div class="fubon-bg p-6 rounded-[2rem] shadow-xl text-white mb-6">
            <h2 class="text-lg font-bold mb-4 flex items-center text-blue-100">
                <i class="fas fa-fingerprint mr-2"></i> 模擬單一事故
            </h2>
            <div class="grid grid-cols-1 gap-4 text-center">
                <button v-for="p in involved" :key="p" @click="setDead(p)"
                    :class="deadPerson === p ? 'bg-yellow-400 text-blue-900 border-white' : 'bg-blue-800 border-blue-700 text-blue-100'"
                    class="w-full py-5 px-6 rounded-2xl text-xl font-black border-2 transition-all active:scale-95 shadow-lg">
                    『{{ p }}』過世
                </button>
            </div>
        </div>

        <div v-if="deadPerson" class="space-y-6">
            <div class="bg-white rounded-[2.5rem] shadow-2xl overflow-hidden border border-gray-200">
                <div :class="riskColor" class="p-5 text-white text-center font-black text-xl tracking-wider">
                    診斷：『{{ deadPerson }}』身故分配風險
                </div>
                
                <div class="p-8">
                    <div v-for="(res, idx) in analysisReports" :key="idx" class="mb-8 last:mb-0">
                        <h3 class="text-xl font-black text-gray-800 mb-3 flex items-center">
                            <span class="w-2 h-6 fubon-bg rounded-full mr-3"></span>{{ res.title }}
                        </h3>
                        <p class="text-gray-700 leading-relaxed font-bold bg-gray-50 p-5 rounded-2xl border-l-4 border-gray-300 shadow-sm" v-html="res.desc"></p>
                    </div>

                    <div v-if="showSubstantialTax" class="mt-8 border-t border-red-100 pt-6">
                        <h3 class="text-lg font-black text-red-600 mb-3 flex items-center">
                            <i class="fas fa-gavel mr-2"></i> 國稅局實質課稅自我檢視
                        </h3>
                        <p class="text-[15px] text-gray-500 mb-4 font-bold">符合以下態樣，保險金仍可能被併入遺產課稅：</p>
                        <div class="grid grid-cols-2 gap-2 text-[14px]">
                            <div v-for="item in substantialList" :key="item" class="flex items-center p-2 bg-red-50 rounded-lg text-red-800 font-bold">
                                <i class="far fa-square mr-2"></i> {{ item }}
                            </div>
                        </div>
                    </div>

                    <div v-if="hasEstateRisk" class="mt-8 bg-blue-50 border-2 border-blue-100 rounded-[2rem] p-6 text-center">
                        <p class="fubon-blue font-black mb-4 leading-relaxed">
                            診斷顯示存在『資產課稅』或『繼承爭議』。<br>想確認精確的遺產稅稅金嗎？
                        </p>
                        <a href="https://liff.line.me/2008902145-EOR8LZNp" class="inline-block w-full bg-orange-600 text-white py-5 rounded-2xl text-xl font-black shadow-lg hover:bg-orange-700 active:scale-95 transition-all">
                            計算精確稅金 <i class="fas fa-calculator ml-1"></i>
                        </a>
                    </div>
                </div>
            </div>

            <div class="pt-6">
                <a href="https://hd022311.github.io/risk-assessment/" class="btn-action w-full text-white py-6 rounded-[2rem] text-2xl font-black shadow-xl flex items-center justify-center animate-bounce-subtle">
                    <i class="fas fa-shield-halved text-3xl mr-3"></i> 60秒，評估家族傳承風險
                </a>
                <p class="text-center text-sm text-gray-500 mt-4 font-bold">即刻進行專業評估，守護家族資產</p>
            </div>
        </div>

        <footer class="mt-12 text-center px-4">
            <div class="h-[1px] bg-gray-300 w-full mb-6"></div>
            <p class="text-[13px] text-gray-400 font-bold leading-relaxed text-justify mb-8">
                ⚠️ 注意事項與警語：<br>
                1. 本工具僅供初步風險診斷參考。實際遺產稅、贈與稅及所得稅之核課，應以財政部國稅局依個案事實、最新法規及「實質課稅原則」認定為準。<br>
                2. 2026年起身故保險金計入基本所得額之免稅扣除額為 3,740 萬元，遺產稅免稅額為 1,333 萬元。相關數據隨物價指數調整，請洽詢專業顧問獲取即時資訊。<br>
                3. 保單架構異動可能影響契約效力或衍生其他稅務，變更前務必諮詢您的保險顧問。
            </p>
            <div class="fubon-blue font-black text-sm tracking-widest opacity-70">
                富邦俊德 ‧ 您的家族資產守護者
            </div>
        </footer>

    </div>

    <script>
        const { createApp, reactive, computed, ref } = Vue;

        createApp({
            setup() {
                const persons = ['父', '母', '大孩子', '二孩子', '三孩子', '爺爺', '奶奶'];
                const roles = reactive({ owner: '父', insured: '母', beneficiary: '大孩子' });
                const deadPerson = ref(null);
                const substantialList = ['高齡投保', '鉅額投保', '密集投保', '短期投保', '帶病投保', '躉繳投保', '舉債投保', '保費大於給付'];

                const availableBeneficiaries = computed(() => persons.filter(p => p !== roles.insured));
                
                const involved = computed(() => {
                    const list = [roles.owner, roles.insured];
                    if (roles.beneficiary !== '法定繼承人') list.push(roles.beneficiary);
                    return [...new Set(list)];
                });

                const setDead = (name) => {
                    deadPerson.value = (deadPerson.value === name) ? null : name;
                };

                const analysis = computed(() => {
                    let r = [];
                    let score = 0;
                    let riskFlag = false;
                    let isSubstantial = false;

                    if (!deadPerson.value) return { reports: r, score, riskFlag, isSubstantial };

                    if (deadPerson.value === roles.owner && deadPerson.value !== roles.insured) {
                        score = 2; riskFlag = true;
                        r.push({ title: "遺產稅申報風險", desc: `因要保人『${roles.owner}』先過世，保單財產價值將計入『${roles.owner}』的遺產總額。` });
                        r.push({ title: "資產凍結風險", desc: `變更要保人須全體繼承人簽名，若一人反對則保單陷入凍結。` });
                    }
                    else if (deadPerson.value === roles.insured) {
                        if (roles.owner === roles.insured) {
                            score = 0; isSubstantial = true;
                            r.push({ title: "理賠金給付順利", desc: `符合「要被同一人」，領取身故金無贈與稅問題，且原則上不計入遺產。但仍須留意下方「實質課稅原則」。` });
                        } 
                        if (roles.owner !== roles.beneficiary && roles.beneficiary !== '法定繼承人') {
                            score = 1; riskFlag = true;
                            r.push({ title: "所得稅最低稅負風險", desc: `因要保人與受益人不同人，同一申報戶身故給付全年超過 <b>3,740 萬元</b>部分需計入所得稅基本所得額。` });
                        }
                        if (roles.beneficiary === '法定繼承人') {
                            score = 1;
                            r.push({ title: "法律預設分配", desc: "保險金將依比例分配給法定繼承人，程序較繁瑣且無法指定特定人領取。" });
                        }
                    }
                    else if (deadPerson.value === roles.beneficiary) {
                        score = 2; riskFlag = true;
                        r.push({ title: "領取權限受阻", desc: `受益人『${roles.beneficiary}』已先身故，理賠金將變回【被保險人】的遺產。` });
                        r.push({ title: "繼承簽名風險", desc: `領取理賠金時，必須備齊被保險人『${roles.insured}』的<b>所有法定繼承人</b>簽名同意，實務上極易產生分產糾紛。` });
                    }

                    return { reports: r, score, hasEstateRisk: riskFlag, isSubstantial };
                });

                return {
                    persons, roles, deadPerson, involved, availableBeneficiaries, substantialList,
                    setDead, 
                    analysisReports: computed(() => analysis.value.reports),
                    hasEstateRisk: computed(() => analysis.value.hasEstateRisk),
                    showSubstantialTax: computed(() => analysis.value.isSubstantial),
                    riskColor: computed(() => ['bg-green-600', 'bg-orange-500', 'bg-red-600'][analysis.value.score])
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
