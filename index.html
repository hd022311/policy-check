<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>富邦俊德｜家族資產守護者</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-size: 19px; font-family: "Microsoft JhengHei", sans-serif; } 
        select { min-height: 60px !important; font-size: 1.2rem !important; font-weight: bold !important; border-radius: 1rem !important; }
        .fubon-blue { color: #00429d; }
        .fubon-bg { background-color: #00429d; }
        .btn-line { background-color: #06C755; }
        .animate-bounce-subtle { animation: bounceSubtle 2s infinite; }
        @keyframes bounceSubtle { 
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }
    </style>
</head>
<body class="bg-gray-50 py-2 min-h-screen">
    <div id="app" class="max-w-xl mx-auto px-4 pb-24">
        
        <header class="py-8 text-center">
            <div class="inline-block border-b-4 border-blue-600 pb-2 mb-2">
                <span class="fubon-bg text-white px-3 py-1 font-black text-xl rounded-md mr-1">富邦</span>
                <span class="fubon-blue text-2xl font-black tracking-widest">俊德</span>
            </div>
            <p class="text-blue-900 font-bold tracking-widest">您的家族資產守護者</p>
        </header>

        <div class="bg-white p-6 rounded-[2rem] shadow-lg border border-gray-100 mb-6">
            <h2 class="text-lg font-black text-gray-800 mb-6 flex items-center">
                <i class="fas fa-id-card-clip mr-2 fubon-blue"></i> 設定保單關係人
            </h2>
            
            <div class="space-y-6">
                <div>
                    <label class="text-xs font-black text-gray-400 uppercase mb-2 block tracking-widest">要保人 (付錢權利人)</label>
                    <select v-model="roles.owner" class="w-full bg-gray-50 border-2 border-gray-100 p-3 outline-none focus:border-blue-500">
                        <option v-for="p in persons" :key="p" :value="p">{{p}}</option>
                    </select>
                </div>

                <div>
                    <label class="text-xs font-black text-gray-400 uppercase mb-2 block tracking-widest">被保險人 (保單標的人)</label>
                    <select v-model="roles.insured" @change="checkBeneficiary" class="w-full bg-gray-50 border-2 border-gray-100 p-3 outline-none focus:border-blue-500">
                        <option v-for="p in persons" :key="p" :value="p">{{p}}</option>
                    </select>
                </div>

                <div>
                    <label class="text-xs font-black text-gray-400 uppercase mb-2 block tracking-widest">身故受益人 (領錢人)</label>
                    <select v-model="roles.beneficiary" class="w-full bg-gray-50 border-2 border-gray-100 p-3 outline-none focus:border-blue-500">
                        <optgroup label="指定人選">
                            <option v-for="p in availableBeneficiaries" :key="p" :value="p">{{p}}</option>
                        </optgroup>
                        <optgroup label="法律預設">
                            <option value="法定繼承人">⚖️ 法定繼承人</option>
                        </optgroup>
                    </select>
                </div>
            </div>
        </div>

        <div class="fubon-bg p-6 rounded-[2rem] shadow-xl text-white mb-6">
            <h2 class="text-lg font-bold mb-4 flex items-center text-blue-100">
                <i class="fas fa-fingerprint mr-2"></i> 模擬單一事故
            </h2>
            <div class="grid grid-cols-1 gap-4 text-center">
                <button v-for="p in involved" :key="p" @click="setDead(p)"
                    :class="deadPerson === p ? 'bg-yellow-400 text-blue-900 border-white' : 'bg-blue-800 border-blue-700 text-blue-100'"
                    class="w-full py-5 px-6 rounded-2xl text-xl font-black border-2 transition-all active:scale-95 shadow-lg">
                    『{{ p }}』過世
                </button>
            </div>
        </div>

        <div v-if="deadPerson" class="space-y-6">
            <div class="bg-white rounded-[2.5rem] shadow-2xl overflow-hidden border border-gray-200">
                <div :class="riskColor" class="p-5 text-white text-center font-black text-xl tracking-wider">
                    診斷：『{{ deadPerson }}』身故分配風險
                </div>
                
                <div class="p-8">
                    <div v-for="(res, idx) in analysisReports" :key="idx" class="mb-8 last:mb-0">
                        <h3 class="text-xl font-black text-gray-800 mb-3 flex items-center">
                            <span class="w-2 h-6 fubon-bg rounded-full mr-3"></span>{{ res.title }}
                        </h3>
                        <p class="text-gray-700 leading-relaxed font-bold bg-gray-50 p-5 rounded-2xl border-l-4 border-gray-300 shadow-sm" v-html="res.desc"></p>
                    </div>

                    <div v-if="hasEstateRisk" class="mt-8 bg-blue-50 border-2 border-blue-100 rounded-[2rem] p-6 text-center">
                        <p class="fubon-blue font-black mb-4 leading-relaxed">
                            保單恐變為『遺產』或產生『贈與稅』風險。<br>想了解具體分配與金額嗎？
                        </p>
                        <a href="https://liff.line.me/2008902145-EOR8LZNp" class="inline-block w-full bg-orange-600 text-white py-5 rounded-2xl text-xl font-black shadow-lg hover:bg-orange-700 active:scale-95 transition-all">
                            進入風險試算工具 <i class="fas fa-chevron-right ml-1"></i>
                        </a>
                    </div>
                </div>
            </div>

            <div class="pt-6">
                <a :href="lineContactLink" class="btn-line w-full text-white py-6 rounded-[2rem] text-2xl font-black shadow-xl flex items-center justify-center animate-bounce-subtle">
                    <i class="fab fa-line text-3xl mr-3"></i> 聯絡俊德保單總體檢
                </a>
                <p class="text-center text-sm text-gray-500 mt-4 font-bold">點擊按鈕將開啟聊天室<br>並自動輸入「我要保單總體檢」</p>
            </div>
        </div>

        <footer class="mt-12 text-center px-4">
            <div class="h-[1px] bg-gray-300 w-full mb-6"></div>
            <p class="text-[12px] text-gray-400 font-bold leading-relaxed text-justify mb-8">
                警語：本工具僅供參考。實際保單分配與稅務問題，請以財政部國稅局最新法規與個案實質課稅原則為準。規劃前請洽專業顧問。
            </p>
            <div class="fubon-blue font-black text-sm tracking-widest opacity-70">
                富邦俊德 ‧ 您的家族資產守護者
            </div>
        </footer>

    </div>

    <script>
        const { createApp, reactive, computed, ref } = Vue;

        createApp({
            setup() {
                // 已更新為您的專屬 ID: @hd022311
                const lineAccountID = "hd022311"; 

                const persons = ['父', '母', '大孩子', '二孩子', '三孩子', '爺爺', '奶奶'];
                const roles = reactive({ owner: '父', insured: '母', beneficiary: '大孩子' });
                const deadPerson = ref(null);

                const availableBeneficiaries = computed(() => persons.filter(p => p !== roles.insured));
                
                const involved = computed(() => {
                    const list = [roles.owner, roles.insured];
                    if (roles.beneficiary !== '法定繼承人') list.push(roles.beneficiary);
                    return [...new Set(list)];
                });

                const setDead = (name) => {
                    deadPerson.value = (deadPerson.value === name) ? null : name;
                };

                const checkBeneficiary = () => {
                    if (roles.insured === roles.beneficiary) roles.beneficiary = availableBeneficiaries.value[0];
                };

                // 更新為對應您 ID 的聯絡連結
                const lineContactLink = computed(() => {
                    const message = encodeURIComponent("我要保單總體檢");
                    return `https://line.me/R/oaMessage/@${lineAccountID}/?${message}`;
                });

                const analysis = computed(() => {
                    let r = [];
                    let score = 0;
                    let riskFlag = false;

                    if (!deadPerson.value) return { reports: r, score, riskFlag };

                    if (deadPerson.value === roles.owner && deadPerson.value !== roles.insured) {
                        score = 2; riskFlag = true;
                        r.push({ title: "資產歸屬風險", desc: `因要保人『${roles.owner}』先過世，該份保單的『現金價值』將計入『${roles.owner}』的『遺產』中。` });
                        r.push({ title: "繼承卡關風險", desc: `變更『新要保人』必須取得『全體繼承人簽名同意』。只要有一人不簽，資產分配將陷入長久凍結。` });
                    }
                    else if (deadPerson.value === roles.insured) {
                        if (roles.owner !== roles.beneficiary && roles.beneficiary !== '法定繼承人') {
                            score = 1; riskFlag = true;
                            r.push({ title: "贈與稅風險", desc: `因『要保人』與『身故受益人』非同一人，保險金給付時將被視為『${roles.owner}』對『${roles.beneficiary}』的贈與。` });
                            r.push({ title: "稅額提示", desc: `若金額超過年度贈與免稅額『244 萬』，要保人須依法申報並繳納『贈與稅』。` });
                        } else if (roles.beneficiary === '法定繼承人') {
                            score = 1;
                            r.push({ title: "分配權限受阻", desc: `保險金將依法律預設比例分配給『法定繼承人』，無法依照您的個人意願給特定人，領取手續亦較為繁瑣。` });
                        } else {
                            score = 0;
                            r.push({ title: "理賠順利給付", desc: `保險金由指定受益人『${roles.beneficiary}』領取，程序最為簡便且分配明確。` });
                        }
                    }
                    else if (deadPerson.value === roles.beneficiary) {
                        score = 2; riskFlag = true;
                        r.push({ title: "分配懸空風險", desc: `受益人『${roles.beneficiary}』已先身故，若未及時變更，未來理賠將變回『被保險人的遺產』，恐引發不必要的繼承紛爭。` });
                    }

                    return { reports: r, score, hasEstateRisk: riskFlag };
                });

                return {
                    persons, roles, deadPerson, involved, availableBeneficiaries, lineContactLink,
                    setDead, checkBeneficiary,
                    analysisReports: computed(() => analysis.value.reports),
                    hasEstateRisk: computed(() => analysis.value.hasEstateRisk),
                    riskColor: computed(() => ['bg-green-600', 'bg-orange-500', 'bg-red-600'][analysis.value.score])
                };
            }
        }).mount('#app');
    </script>
</body>
</html>